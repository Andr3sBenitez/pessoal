<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Mini Labirinto</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      color: #333;
    }
    h1 {
      margin-top: 20px;
    }
    #gameContainer {
      margin-top: 20px;
      display: grid;
      grid-template-columns: repeat(10, 40px);
      grid-template-rows: repeat(10, 40px);
      gap: 2px;
      background-color: #eee;
      border: 2px solid #ccc;
    }
    .tile {
      width: 40px;
      height: 40px;
      background-color: white;
      box-sizing: border-box;
      border: 1px solid #ddd; /* para ver melhor os quadrados */
    }
    .wall {
      background-color: #ccc;
    }
    .player {
      background-image: url("sprites/player.png");
      background-size: cover;
    }
    .key {
      background-image: url("sprites/key.png");
      background-size: cover;
    }
    .door {
      background-image: url("sprites/door.png");
      background-size: cover;
    }
  </style>
</head>
<body>
  <h1>ðŸŽ¯ Pegue a chave e abra a porta para desbloquear</h1>

  <div id="gameContainer"></div>

  <script>
    const gameSize = 10;
    const map = [
      "##########",
      "#k       #",
      "# ###### #",
      "# #    # #",
      "# # ## # #",
      "# # ## # #",
      "# #     ##",
      "# ###### #",
      "#      pD#",
      "##########"
    ];

    const gameContainer = document.getElementById("gameContainer");

    let playerPos = { x: 7, y: 8 };
    let hasKey = false;

    function drawMap() {
      gameContainer.innerHTML = "";
      for (let y = 0; y < gameSize; y++) {
        for (let x = 0; x < gameSize; x++) {
          const tile = document.createElement("div");
          tile.classList.add("tile");
          const cell = map[y][x];

          if (x === playerPos.x && y === playerPos.y) {
            tile.classList.add("player");
          } else if (cell === "#") {
            tile.classList.add("wall");
          } else if (cell === "k") {
            tile.classList.add("key");
          } else if (cell === "D") {
            tile.classList.add("door");
          }

          gameContainer.appendChild(tile);
        }
      }
    }

    function movePlayer(dx, dy) {
      const newX = playerPos.x + dx;
      const newY = playerPos.y + dy;
      const nextCell = map[newY][newX];

      if (nextCell === "#") return;

      if (nextCell === "k") {
        hasKey = true;
        map[newY] = replaceAt(map[newY], newX, " ");
      }

      if (nextCell === "D") {
        if (hasKey) {
          map[newY] = replaceAt(map[newY], newX, " ");
          // redirecionar ao abrir a porta
          window.location.href = "main.html";
        } else {
          return;
        }
      }

      playerPos = { x: newX, y: newY };
      drawMap();
    }

    function replaceAt(str, index, replacement) {
      return str.substring(0, index) + replacement + str.substring(index + 1);
    }

    document.addEventListener("keydown", (e) => {
      switch (e.key) {
        case "ArrowUp":
        case "w":
        case "W":
          movePlayer(0, -1);
          break;
        case "ArrowDown":
        case "s":
        case "S":
          movePlayer(0, 1);
          break;
        case "ArrowLeft":
        case "a":
        case "A":
          movePlayer(-1, 0);
          break;
        case "ArrowRight":
        case "d":
        case "D":
          movePlayer(1, 0);
          break;
      }
    });

    drawMap();
  </script>
</body>
</html>
